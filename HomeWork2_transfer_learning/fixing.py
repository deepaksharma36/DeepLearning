import matplotlib.pyplot as plt
BATCH_SIZE=32
LEARNING_RATE=0.05
REGULARIZATION_CONST=0
MOMENTUM=0.7
EPOCHES=100
#[1.2453547766160626, 0.85527391663101915]
def loss_accuracy_vs_epoch_curve(fig1,loss_matrix_training,
                                 accuracy_matrix_training,loss_matrix_testing=None,accuracy_matrix_testing=None):
    """
    Generate loss and accuracy curves
    :param fig1:
    :param loss_matrix_training:
    :param accuracy_matrix_training:
    :param loss_matrix_testing:
    :param accuracy_matrix_testing:
    :return:
    """
    loss__curve = fig1.add_subplot(121)
    loss__curve.plot(loss_matrix_training, label='Training')
    loss__curve.plot(loss_matrix_testing, label='Validation')
    loss__curve.text(1,1,"BATCH SIZE: "+str(BATCH_SIZE)+"\nLEARNING RATE: "+str(LEARNING_RATE)+"\n "
                "REGULARIZATION_CONST: "+str(REGULARIZATION_CONST)+"\nMOMENTUM: "+ str(MOMENTUM))
    loss__curve.set_title("Cross Entropy Loss")

    loss__curve.set_xlabel("Epochs count")
    loss__curve.set_ylabel(" Loss")
    loss__curve.legend()

    accuracy__curve= fig1.add_subplot(122)

    accuracy__curve.plot(accuracy_matrix_training, label='Training')
    accuracy__curve.plot(accuracy_matrix_testing, label='Validation')
    accuracy__curve.set_title("Mean Per Class Accuracy")
    accuracy__curve.set_xlabel("Epochs count")
    accuracy__curve.set_ylabel("Accuracy")
    accuracy__curve.legend(loc='upper left')

    return fig1
def history(train_history):
    loss=train_history['loss']
    accuracy=train_history['acc']
    val_loss=train_history['val_loss']
    val_acc=train_history['val_acc']
    loss_accuracy_fig = plt.figure()
    loss_accuracy_vs_epoch_curve(loss_accuracy_fig,loss,accuracy,val_loss,val_acc)
    plt.show()

history_dtl={'val_acc': [0.60054347826086951, 0.82608695652173914, 0.83423913043478259, 0.83423913043478259, 0.79619565217391308, 0.82880434782608692, 0.80978260869565222, 0.84782608695652173, 0.84782608695652173, 0.85597826086956519, 0.84239130434782605, 0.86684782608695654, 0.86141304347826086, 0.85326086956521741, 0.85869565217391308, 0.86141304347826086, 0.86141304347826086, 0.85869565217391308, 0.87771739130434778, 0.87228260869565222, 0.87228260869565222, 0.86141304347826086, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.875, 0.875, 0.875, 0.875, 0.875, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.875, 0.875, 0.875, 0.875, 0.875, 0.875, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.87228260869565222, 0.86956521739130432, 0.87771739130434778, 0.87771739130434778, 0.875, 0.87771739130434778, 0.87771739130434778, 0.875, 0.875, 0.875, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.86956521739130432, 0.86956521739130432, 0.875, 0.87771739130434778, 0.88043478260869568, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.87771739130434778, 0.875, 0.875, 0.875, 0.875, 0.875, 0.875, 0.86956521739130432, 0.86956521739130432, 0.875, 0.86141304347826086, 0.84239130434782605, 0.86141304347826086, 0.85326086956521741, 0.86956521739130432, 0.86141304347826086, 0.86413043478260865, 0.86141304347826086, 0.85597826086956519, 0.85869565217391308, 0.86141304347826086, 0.85597826086956519], 'val_loss': [2.7104399618895156, 1.6014777732932048, 0.79656072187682858, 0.53566170921144274, 0.73647702774716262, 0.85739693213659141, 1.3442240390591589, 1.0125114815176779, 1.0505736587312402, 0.9191587016634325, 1.1462014845531925, 1.0825349218009612, 1.0240931698809506, 1.1104592259811326, 1.0844375270864244, 1.0792606479447826, 1.1137980883536138, 1.0949394780656572, 1.0135096298611688, 1.0652727704981104, 1.0466750432615701, 1.1131364102272958, 1.001293221245642, 1.0554665064682138, 1.0438055935437272, 1.0156826125862812, 0.99954125090785706, 1.0111422098201259, 1.0100785273572679, 1.0059211727069779, 1.0116057564382974, 0.9943272996207948, 1.0015840601661936, 1.0033126803843877, 1.0078652125337855, 1.0054707974195487, 0.99860449167697385, 0.97708800564641596, 0.97801307426846606, 0.98068889198095965, 0.98353196907302665, 0.9836007818255742, 0.98987132003125999, 0.98510355421382512, 0.98684441395427935, 0.98009300507281194, 0.97829043103948943, 0.98093491274377631, 0.98969532290230688, 1.0104895247065508, 1.0203421485164896, 0.94313613228176008, 0.98235124803107776, 0.98106245113455792, 0.93397914132346338, 0.94657678448635663, 0.9569167864063518, 0.95341178774833746, 0.95899882199971631, 0.95908301809559759, 0.95631982904413537, 0.96354167228159759, 0.94304801199747235, 0.9361202224441203, 0.9508049889751109, 0.94675514166769836, 0.94854492273019775, 0.95309729242454466, 0.99115778181863934, 0.98523697127466681, 0.98559574588485444, 0.97335462725680866, 0.97551083046457099, 0.97042873890503656, 0.97119708035303265, 0.97380901743536474, 0.97323695926562659, 0.96786571844764435, 0.96855161047500171, 0.96875302882298242, 0.97394683697949347, 0.97424606460592078, 0.9782241751318399, 0.99361222204954791, 0.9877349714870044, 0.97868496519715953, 0.9727567591420988, 0.97743125778177575, 1.1022051456181905, 1.1202886506267222, 1.0066616988700374, 1.0685826444431499, 0.99115550453248291, 1.0139870028132985, 1.013732135943745, 1.059237920719645, 1.0501815262048146, 1.0505589933499053, 1.0445203262826677, 1.055681971752126], 'acc': [0.71890096618357491, 0.85748792270531404, 0.89734299516908211, 0.92059178743961356, 0.94474637681159424, 0.96437198067632846, 0.96557971014492749, 0.97192028985507251, 0.98067632850241548, 0.98369565217391308, 0.9873188405797102, 0.99335748792270528, 0.99245169082125606, 0.99486714975845414, 0.9969806763285024, 0.99637681159420288, 0.99607487922705318, 0.99758454106280192, 0.99637681159420288, 0.9966787439613527, 0.99728260869565222, 0.99637681159420288, 0.99728260869565222, 0.99728260869565222, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99728260869565222, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99728260869565222, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.9969806763285024, 0.99758454106280192, 0.9969806763285024, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.9969806763285024, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99728260869565222, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.99758454106280192, 0.9969806763285024, 0.9966787439613527, 0.99758454106280192, 0.99758454106280192, 0.99728260869565222, 0.99788647342995174, 0.99788647342995174, 0.99758454106280192, 0.99788647342995174, 0.99788647342995174, 0.99788647342995174, 0.99788647342995174], 'loss': [1.965197043142457, 1.0515572011902712, 0.73742718247759742, 0.49010394172347038, 0.36905538720140069, 0.22468854621649439, 0.20047448355657635, 0.17842327999740931, 0.12237576922598237, 0.117284565626825, 0.080187969238777621, 0.05940741094083981, 0.062515918012940208, 0.049012566373538936, 0.041379441937559262, 0.04241924426161215, 0.046906214068764496, 0.039842233209741389, 0.042862371538556057, 0.040491886595301708, 0.040119657159343791, 0.044372929521255239, 0.041825163793134286, 0.039691362156547172, 0.039204710103248268, 0.039190732847187187, 0.039148680250200373, 0.039083068945024245, 0.0391272702187428, 0.039030773670605881, 0.039141988153847458, 0.039732510772376932, 0.039102277052732358, 0.039068950310003903, 0.039043280128069638, 0.03963669013785695, 0.039054600421171405, 0.039030543136476172, 0.039329650730828558, 0.039203373208636094, 0.039121383091099228, 0.038985624789482469, 0.039010895227265391, 0.039058364835574448, 0.039000913336693428, 0.039187366215531497, 0.039124476700882711, 0.039058140064566517, 0.039092775293708464, 0.039058829190914413, 0.039022449257276014, 0.039218913964272836, 0.039403974934264431, 0.039253737906972931, 0.040929462359830381, 0.039032829468451456, 0.040325327438291945, 0.03910054926857378, 0.039010903560309722, 0.039036323416874678, 0.039727984183057362, 0.038982000649095037, 0.039050333426940399, 0.038978605032054921, 0.039024394280542059, 0.038962215985712007, 0.038967052077514913, 0.039025715303633732, 0.039537259641517386, 0.038979449780645277, 0.039054758033963299, 0.039194527313464837, 0.039071309786634624, 0.039054855077594035, 0.038960756283060845, 0.039006079329527911, 0.038973726424726129, 0.038969003906315892, 0.038957284676653846, 0.038991976979425962, 0.038968830839486691, 0.039018395473568071, 0.039017352751249325, 0.03902461774835736, 0.038961332852333698, 0.039092072040454381, 0.038986102277269757, 0.039036119034509535, 0.040682314581955127, 0.041969822909611577, 0.034592208729354874, 0.034981427784129833, 0.034693328470480761, 0.034136801260811492, 0.034163425691139164, 0.034735516062467692, 0.034167417535226403, 0.034125728329069509, 0.034106033655096443, 0.034326949652452546]}
history(history_dtl)
